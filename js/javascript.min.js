$(document).ready(function(){function i(e,t){"false"==a&&toastr[e](t)}toastr.options={closeButton:!1,debug:!1,newestOnTop:!1,progressBar:!1,positionClass:"toast-bottom-full-width",preventDuplicates:!1,showDuration:"200",hideDuration:"500",timeOut:"2500",extendedTimeOut:"500",showEasing:"swing",hideEasing:"linear",showMethod:"fadeIn",hideMethod:"fadeOut"};var e,t,a;"undefined"!=typeof Storage?(null===localStorage.getItem("time")?t=localStorage.setItem("time",500):(t=localStorage.getItem("time"),$("#time").val(t/1e3)),null===localStorage.getItem("toast")?(localStorage.setItem("toast","true"),e="true"):e=localStorage.getItem("toast"),null===localStorage.getItem("toast_hide")?(localStorage.setItem("toast_hide",!1),a="false"):(a=localStorage.getItem("toast_hide"),"true"==a&&$("#toast-hide").attr("checked",!0)),"false"==e?$("#powiadomienie1 + label").addClass("active"):$("#powiadomienie0 + label").addClass("active")):(toastr.info("Twoja przeglądarka nie obsługuję tej funkcji."),t=500,e="true"),$(".btn-preference").on("click",function(){$("p.preference-time").is(":visible")&&$("p.preference-time").hide(),$(".modal-container-preferences").hide(),a=$("#toast-hide").is(":checked")?"true":"false";var o=parseFloat($("#time").val());$("#powiadomienie1").is(":checked")&&!isNaN(o)?(t=1e3*o,e="false",localStorage.setItem("time",t),localStorage.setItem("toast",e),$("#powiadomienie1 + label").addClass("active"),$("#powiadomienie0 + label").hasClass("active")&&$("#powiadomienie0 + label").removeClass("active"),i("info","Błędne odpowiedzi będą wyróżnione przez "+o+" sekundy.")):$("#powiadomienie0").is(":checked")&&(t=500,e="true",localStorage.setItem("time",t),localStorage.setItem("toast",e),$("#powiadomienie0 + label").addClass("active"),$("#powiadomienie1 + label").hasClass("active")&&$("#powiadomienie1 + label").removeClass("active"),$('[name="ODP"] + label').hasClass("bad-answer")&&$('[name="ODP"] + label').removeClass("bad-answer good-answer"),i("info","Błędne odpowiedzi będą wyświetlane w powiadomieniach")),i("info","Ustawienia zapisano."),localStorage.setItem("toast_hide",a),$("input[name=powiadomienie]:checked").prop("checked",!1)});var l,o=function(){var e=$("body").height()/100*2,t=10*e;$("[id=info]").hasClass("fill-greenlight")?($(this).removeClass("fill-greenlight"),$(this).addClass("fill-white"),$("footer").removeAttr("style"),$(".scoreboard").animate({bottom:0,opacity:"0"},t,function(){$(".scoreboard").css("display","none")})):($(this).removeClass("fill-white"),$(this).addClass("fill-greenlight"),$("footer").css("box-shadow","none"),$(".scoreboard").removeAttr("style"),$(".scoreboard").animate({bottom:e,opacity:"1.0"},t,function(){}))},s=!1,r=!1,n=function(){$.ajax({type:"POST",url:"resources/gate.php",data:{action:"getQuestion"},statusCode:{200:function(e){var t=JSON.parse(e),a=$(".image");t.IMG?a.hasClass("hidden")?($(".image img").attr("src","resources/img/"+t.IMG),a.removeClass("hidden")):$(".image img").attr("src","resources/img/"+t.IMG):a.hasClass("hidden")||a.addClass("hidden"),$("div.question").html(t.PYTANIE);var i=$(".shuffle");$("input[type=radio]:checked").prop("checked",!1);for(var o=0;o<i.length;o++){var s=Math.floor(Math.random()*i.length-1)+1,r=Math.floor(Math.random()*i.length-1)+1;i.eq(s).before(i.eq(r))}$("label[for=odp1]").html(t.ODP1),$("label[for=odp2]").html(t.ODP2),$("label[for=odp3]").html(t.ODP3),$("label[for=odp4]").html(t.ODP4),$("input[name=POPODP]").val(t.POPODP),$("input[name=POPODP]").attr("id",t.ID),$(".submit").attr("disabled",!1),$(".submit").blur(),no_question=!1},204:function(){s=!0,$("div.question").text("Brak pytań w wybranej kategori, wybierz inną."),$("label[for=odp1]").text(""),$("label[for=odp2]").text(""),$("label[for=odp3]").text(""),$("label[for=odp4]").text(""),$("input[name=POPODP]").val("0"),$("input[name=POPODP]").attr("id","0"),$(".submit").attr("disabled",!0)}},complete:function(){"false"==e&&$('[name="ODP"] + label').removeClass("bad-answer good-answer"),$(".bar").removeClass("bar-itself"),r=!1}})},c=function(){if($(".submit").attr("disabled",!0),$('[name="ODP"]').is(":checked")&&r===!1&&s===!1){r=!0,$(".bar").addClass("bar-itself"),$("input[type=radio]:checked").val()==$("input[name=POPODP]").val()?(i("success","Poprawna odpowiedź."),l="true"):("false"==e&&($("label[for=odp"+$("input[name=POPODP]").val()+"]").addClass("good-answer"),$('[name="ODP"]:checked + label').addClass("bad-answer"),i("error","Odpowiedź niepoprawna!")),"true"==e&&i("error","Odpowiedź niepoprawna, poprawna: <span style='text-decoration:underline;'>"+$("label[for=odp"+$("input[name=POPODP]").val()+"]").text()),l="false");var a=$("input[name=POPODP]").attr("id");$.ajax({type:"POST",url:"resources/gate.php",data:{action:"addScore",answer:l,answerid:a},success:function(e){e=JSON.parse(e),$("#j_cscore").text(e.c_score),$("#j_cscoreright").text(e.c_score_right);var t=e.c_score-e.c_score_right;$("#j_cscorebad").text(t),$("#j_score").text(e.score),$("#j_scoreright").text(e.score_right);var a=e.score-e.score_right;$("#j_scorebad").text(a)}}),t>500&&"false"==l?setTimeout(n,t):setTimeout(n,500)}else i("info","Zaznacz odpowiedź."),$(".submit").attr("disabled",!1),$(".submit").blur()};if($("[id=info]").click(o),$(".submit").click(c),$(".change-category").click(function(){$(".modal-container").show(),$(".modal-container").click(function(e){$(e.target).is(this)&&$(".modal-container").hide()}),$(".close-button").click(function(){$(".modal-container").hide()})}),$(".set-preferences").click(function(){$(".modal-container-preferences").show(),$(".modal-container-preferences").click(function(e){$(e.target).is(this)&&$(".modal-container-preferences").hide()}),$(".close-button-preferences").click(function(){$(".modal-container-preferences").hide()})}),$("#powiadomienie1").on("click",function(){$("p.preference-time").show()}),$("#powiadomienie0").on("click",function(){$("p.preference-time").is(":visible")&&$("p.preference-time").hide()}),$.ajax({type:"POST",url:"resources/gate.php",data:{action:"getCategoryIndex"},success:function(e){var t=parseInt($("#j_category").text()),e=JSON.parse(e),a=$(".modal-container div.modal-body");a.append('<button id="0" class="btn-category btn">Brak</button>');for(var i in e)a.append('<button id="'+e[i].ID_CAT+'" class="btn-category btn">'+e[i].NAME+"</button>"),t==e[i].ID_CAT&&$("#j_category").text(e[i].NAME)}}),$(".modal-body").on("click",".btn-category",function(){$(".submit").attr("disabled",!0),$(".bar").addClass("bar-itself");var e=$(this).text(),t=$(this).attr("id");$.ajax({type:"POST",url:"resources/gate.php",data:{action:"changeCategory",idcat:t},success:function(){i("info","Zmieniono kategorie na "+e),$("#j_category").text(e)},complete:function(){n()}}),$(".modal-container").hide(),$(".bar").removeClass("bar-itself")}),$(".delete-score").click(function(){$(".bar").addClass("bar-itself"),confirm("Twoje wyniki zostaną usunięte, czy jesteś pewien tej decyzji?")&&($.ajax({type:"POST",url:"resources/gate.php",data:{action:"resetScore"}}),$("#j_cscore").text("0"),$("#j_cscoreright").text("0"),$("#j_cscorebad").text("0"),$("#j_score").text("0"),$("#j_scoreright").text("0"),$("#j_scorebad").text("0"),i("info","Wyniki zostały usunięte.")),$(".delete-score").blur(),$(".bar").removeClass("bar-itself")}),$(".mobile-only").is(":hidden")){var d=!1;$(document).on("keypress",function(e){if(0==d)switch(d=!0,e.which){case 113:$("span.shuffle:first-of-type input[type=radio]").prop("checked",!0);break;case 119:$("span.shuffle:nth-of-type(2) input[type=radio]").prop("checked",!0);break;case 101:$("span.shuffle:nth-of-type(3) input[type=radio]").prop("checked",!0);break;case 114:$("span.shuffle:nth-of-type(4) input[type=radio]").prop("checked",!0);break;case 32:$(".submit").click();break;case 105:$("[id=info]").click();break;case 99:$(".modal-content").is(":visible")?$(".close-button").click():$(".change-category").click();break;case 117:$(".modal-container-preferences").is(":visible")?$(".close-button-preferences").click():$(".set-preferences").click()}}),$(document).on("keyup",function(){d=!1})}if($(".mobile-only").is(":visible")){var f=!1;$(document).on("swipeleft",function(){$(".submit").click(),0==f&&($(".mobile-helper").hide(),f=!0)})}});